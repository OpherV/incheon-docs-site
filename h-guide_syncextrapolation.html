<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Synchronization Methods: Extrapolation - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="https://file.myfontastic.com/DeXq9523CzrFERZkXSzP7D/icons.css" rel="stylesheet">
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2 class="home"><a href="index.html">Incheon</a></h2><h2>For humans</h2><ul class="tutorials"><li><a href="h-prologue.html">Prologue</a></li><li><a href="h-guide.html">Guide</a><ul><li><a href="h-guide_gameengine.html">The Game Engine</a></li><li><a href="h-guide_serverengine.html">The Server Engine</a></li><li><a href="h-guide_clientengine.html">The Client Engine</a></li><li><a href="h-guide_renderer.html">The Renderer</a></li><li><a href="h-guide_gameworld.html">The Game World and Game Objects</a></li><li><a href="h-guide_serialization.html">Serialization and Communication</a></li><li><a href="h-guide_syncinterpolation.html">Synchronization Methods: Interpolation</a></li><li><a href="h-guide_syncextrapolation.html">Synchronization Methods: Extrapolation</a></li></ul></li><li><a href="h-tutorials.html">Tutorials</a><ul><li><a href="h-MyFirstGame.html">My First Game: pong</a></li><li><a href="h-spaceships.html">Spaaace</a></li></ul></li><li><a href="h-furtherreading.html">Further Reading</a></li></ul><h2>For Machines</h2><h3 class="classes">Classes</h3><ul><li><a href="ClientEngine.html">ClientEngine</a><ul class='methods'><li data-type='method'><a href="ClientEngine.html#sendInput">sendInput</a></li></ul></li><li><a href="DynamicObject.html">DynamicObject</a><ul class='methods'><li data-type='method'><a href="DynamicObject.html#init">init</a></li><li data-type='method'><a href="DynamicObject.html#toString">toString</a></li></ul></li><li><a href="GameEngine.html">GameEngine</a><ul class='methods'><li data-type='method'><a href="GameEngine.html#on">on</a></li><li data-type='method'><a href="GameEngine.html#once">once</a></li><li data-type='method'><a href="GameEngine.html#processInput">processInput</a></li><li data-type='method'><a href="GameEngine.html#start">start</a></li></ul></li><li><a href="Renderer.html">Renderer</a><ul class='methods'><li data-type='method'><a href="Renderer.html#addObject">addObject</a></li><li data-type='method'><a href="Renderer.html#draw">draw</a></li><li data-type='method'><a href="Renderer.html#init">init</a></li><li data-type='method'><a href="Renderer.html#removeObject">removeObject</a></li></ul></li><li><a href="Serializer.html">Serializer</a><ul class='methods'><li data-type='method'><a href="Serializer.html#addCustomType">addCustomType</a></li><li data-type='method'><a href="Serializer.html#registerClass">registerClass</a></li></ul></li><li><a href="ServerEngine.html">ServerEngine</a></li></ul><h3 class="events">Events</h3><ul><li><a href="GameEngine.html#event:objectAdded">objectAdded</a></li><li><a href="GameEngine.html#event:objectDestroyed">objectDestroyed</a></li><li><a href="GameEngine.html#event:playerDisconnected">playerDisconnected</a></li><li><a href="GameEngine.html#event:playerJoined">playerJoined</a></li><li><a href="GameEngine.html#event:postStep">postStep</a></li><li><a href="GameEngine.html#event:preStep">preStep</a></li><li><a href="GameEngine.html#event:syncReceived">syncReceived</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">Synchronization Methods: Extrapolation</h1>
    

    <section>

<header>
    
</header>

<article>
    <h1>Synchronization Methods: Extrapolation</h1><p>A different approach to synchronization is to extrapolate the game’s progress on the client, in the absence of sync data from the server.  Once sync data does arrive from the server, a client must reconcile between the game state predicted on the client, and the game state that actually occurred on the server.</p>
<p>In the diagram above, while the server is playing out step 1026, the clients are simultaneously rendering step 1030, which didn’t happen yet on the server.  This implies that the clients used extrapolation to predict the future.</p>
<p>Extrapolation is tunable, just like interpolation, by setting the number of steps that a client should be ahead of the server.  Ideally, the client is just a little bit ahead, just enough so that when sync data arrives, the highest step information in the sync matches the current step played out on the client.</p>
<p>An input which is sent by a client may arrive before the server has started playing the corresponding step.  In this case the Server can be configured to wait for the input’s step.  Since the server will process the input at a later step, the client may want to impose an artificial delay before actually enacting the input locally.  This is another tunable parameter.</p>
<p>When a sync arrives at the client, the client must reconcile the predicted game state with the actual (server) game state.  This is performed as follows:</p>
<ol>
<li><p>Client is at step N.</p>
</li>
<li><p>Roll back the state to the step described by the server in the sync, step M.</p>
</li>
<li><p>Re-enact all the steps between M and N by invoking the game engine’s step() method.</p>
</li>
<li><p>The game objects positions have shifted from the predicted value.  Revert back to the client’s expected position, but remember the required delta between the client and the server.</p>
</li>
<li><p>Apply the delta so that the object on the client gradually bends towards the correct position as indicated by the server.</p>
<ol>
<li><p>Not all the delta is applied.  A &quot;bending factor&quot; must be specified, to indicate how much of the delta should be applied.  A bending factor of 30% means that 30% of the correction will be applied until the next sync data arrives.</p>
</li>
<li><p>The delta is not applied in a single step.  Rather, split the correction into incremental corrections that are applied until the next sync data arrives.</p>
</li>
</ol>
</li>
</ol>
<p>Notes for the game developer: Multiple complications arise from the extrapolation method.</p>
<ol>
<li><p><strong>Re-enactment</strong>.  Interpolation re-enacts the game steps, and sometimes it may re-enact many steps.  This means that the game engine must be capable of stepping through the same step multiple times.  These are known as re-enactment steps.  The step() method is passed an argument so that it can know when a step is a re-enactment step.</p>
</li>
<li><p><strong>Bending</strong>.  The client’s objects positions gradually bend towards the server’s positions.  Velocity can also bend.  The game designer must choose bending values carefully.  Objects whose position can change suddenly (teleporting objects) will not bend well.  Objects whose velocity can change suddenly (impulse) should not have velocity bending.</p>
</li>
<li><p><strong>Shadow Objects.</strong> The client may create an object which does not yet exist on the server.  For example, if a ship fires a missile, the client must render a missile, even though the missile object is yet to exist on the server.  Until the true missile object will be created on the server, the client will model the missile with a shadow object.</p>
</li>
</ol>
</article>

</section>

<style>
#main > h1{ display: none }
</style>

</div>

<br class="clear">

<footer>

</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-88335360-1', 'auto');
  ga('send', 'pageview');

</script>
<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>